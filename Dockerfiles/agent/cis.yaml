schemaVersion: '2.0.0'
commandTests:
  # CIS 5.1.x
  - name: "Ensure cron daemon is not enabled"
    command: "bash"
    args: ["-c", "service --status-all 2>/dev/null | grep -Fq 'crond'"]
    exitCode: 1

  # CIS 5.2.x
  - name: "Ensure ssh service is not endabled"
    command: "bash"
    args: ["-c", "service --status-all 2>/dev/null | grep -Fq 'sshd'"]
    exitCode: 1

  # CIS 2.2.16
  - name: "Ensure rsync service is not enabled"
    command: "bash"
    args: ["-c", "service --status-all 2>/dev/null | grep -Fq 'rsync'"]
    exitCode: 1

  # CIS 2.2.16
  - name: "Ensure rsync is not installed"
    command: "bash"
    args: ["-c", "which rsync"]
    exitCode: 1

  # CIS 2.3.4
  - name: "Ensure telnet client is not installed"
    command: "bash"
    args: ["-c", "which telnet"]
    exitCode: 1

  # CIS 6.1.10
  - name: "Ensure no world writable files exist"
    command: "bash"
    args: ["-c", "df --local -P | awk -F 'NR!=1 { print $6 }' | xargs -I {} find {} -xdev -type f -perm -0002"]
    expectedOutput: [""]

  # CIS 6.1.11
  - name: "Ensure no unowned files or directories exist"
    command: "bash"
    args: ["-c", "df --local -P | awk -F 'NR!=1 { print $6 }' | xargs -I {} find {} -xdev -nouser"]
    expectedOutput: [""]

  # CIS 6.1.12
  - name: "Ensure no ungrouped files or directories exist"
    command: "bash"
    args: ["-c", "df --local -P | awk -F 'NR!=1 { print $6 }' | xargs -I{} find {} -xdev -nogroup"]
    expectedOutput: [""]

fileExistenceTests:
  # CIS 1.3.2-3
  - name: "Ensure sudo is not installed"
    path: "/usr/bin/sudo"
    shouldExist: false
